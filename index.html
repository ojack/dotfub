<script type="module">

  import Squirm from './Squirm.js'


  const cloneSquirm = (s) => {
    const newSquirm = new Squirm()
    newSquirm.data = Object.assign({}, s.data)
    newSquirm.metadata = Object.assign({}, s.metadata)
    return newSquirm
  }
  const addTickFunctional = (s) => (dataPoint) => {
    // s.weird.push(data)
    Object.keys(s.data).forEach(key => {
      let newVal = dataPoint[key]
      if(!key in dataPoint) {
        // todo get last value here
        console.warn(`missing data for ${key}, using last value instead`)
      }
      s.data[key].push(newVal)
    })
    return s
  }

  // functions and methods generated by computer
  const addTick = (s, data) => {
    const clone = cloneSquirm(s)
    addTickFunctional(clone)(data)
    return clone
  }

  Squirm.prototype.addTick = function (data) {
    console.log(data, this)
    return addTickFunctional(this)(data)
  }

  // const addTick = (Squirm, data) => {
  //   const myFunction = addTickFunctional(Squirm)
  //   return myFunction(data)
  // }

  // Testing 
  const squirm = new Squirm()
  squirm.addTick({ t: 1, x: 100, y: 100 })

  const squirm2 = addTick(squirm, { t: 2, x: 200, y: 200 })

  squirm2.addTick({ t: 3, x: 300, y: 300 })


  console.log('first', squirm)
  console.log('second', squirm2)


</script>
Ã¥