<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>squirm generator</title>
</head>

<body>
    <canvas id="squirm-canvas"></canvas>
    <script type="module">
        import { Squirm, squirmActions } from './main.js'
        const { convertToString, cloneSquirm, addTick } = squirmActions

        const canvas = document.querySelector('#squirm-canvas')
        canvas.width = window.innerWidth
        canvas.height = window.innerHeight
        const ctx = canvas.getContext('2d')

        let startTime = null
        let currentSquirm = null
        
        canvas.addEventListener("pointerdown", (e) => {
            ctx.clearRect(0, 0, canvas.width, canvas.height)
            startTime = performance.now()
            currentSquirm = new Squirm()
            currentSquirm.addTick({ t: 0, x: e.clientX, y: e.clientY })
        });

        canvas.addEventListener("pointermove", (e) => {
            // console.log(e)
            if (currentSquirm !== null) {
                currentSquirm.addTick({ x: e.clientX, y: e.clientY, t: performance.now() - startTime })
                ctx.fillRect(e.clientX, e.clientY, 10, 10)
            }
        })

        canvas.addEventListener("pointerup", (e) => {
            console.log(e)
            // console.log('f')
            //squirm.push({ x: e.clientX, y: e.clientY })
            console.log(currentSquirm)
            currentSquirm.saveToFile()
            currentSquirm = null
            //generateSquirmFormat(squirm)
        })

    </script>
</body>

</html>